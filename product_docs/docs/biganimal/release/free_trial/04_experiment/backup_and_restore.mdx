---
title: Backup and restore a cluster
navTitle: "Backup and restore" 
indexCards: none
---

1. [Create a cluster](create_cluster_cli)

2. [Create a new role/db called baseball](/biganimal/latest/using_cluster/01_postgres_access/#one-database-with-one-application)

3. Connect to the baseball database
```sql
\c baseball
```

4. Change the prompt so that we have an accurate timestamp for knowing when to recover.
```sql
baseball=> \set PROMPT1 '%`date +%H:%M:%S` %/%R%# '
Create a table for batters. 
CREATE TABLE batters (
                      id SERIAL,
                      playerid VARCHAR(9),
                      yearid INTEGER,
                      stint INTEGER,
                      teamid VARCHAR(3),
                      lgid VARCHAR(2),
                      g INTEGER,
                      ab INTEGER,
                      r INTEGER,
                      h INTEGER,
                      "2b" INTEGER,
                      "3b" INTEGER,
                      hr INTEGER,
                      rbi INTEGER,
                      sb INTEGER,
                      cs INTEGER,
                      bb INTEGER,
                      so INTEGER,
                      ibb INTEGER,
                      hbp INTEGER,
                      sh INTEGER,
                      sf INTEGER,
                      gidp INTEGER,
                      PRIMARY KEY (id)
);
```

5. Populate the table from the internet.
```sql
\COPY batters(playerid,yearid,stint,teamid,lgid,g,ab,r,h,"2b","3b",hr,rbi,sb,cs,bb,so,ibb,hbp,sh,sf,gidp) FROM PROGRAM 'curl "https://raw.githubusercontent.com/chadwickbureau/baseballdatabank/master/core/Batting.csv"' DELIMITER ',' CSV HEADER
```

6. Make sure there is data in the table using select.
```sql
select playerid, yearid, teamid,
       rank() OVER (PARTITION BY yearid ORDER BY hr desc) hr_rank,
       hr
from batters
where yearid = 1998
order by hr_rank limit 5;
```

7. Drop that table! (Note the time!)
```sql
10:00:39 baseball=> drop table batters;
DROP TABLE
```

8. Re-run the select to verify the data is gone.

9. For the free trial, you are limited to one active cluster. Restoring a cluster creates a brand new cluster that is initialized with the cluster backup. Quit psql (\q) and delete the cluster from the command line.
```shell
./biganimal delete-cluster --id p-xxxxxxxxxxx
```

10. Restore the cluster using the timestamp before the time you dropped the table. (This currently requires using the web interface.)

11. Check the status of the new cluster from the command line.
```shell
./biganimal show-clusters
```

12. Log into the new cluster. Again use the edb_admin password used when creating the cluster you recently deleted.

13. Verify that the batters table has been restored:
```sql
select playerid, yearid, teamid,
       rank() OVER (PARTITION BY yearid ORDER BY hr desc) hr_rank,
       hr
from batters
where yearid = 1998
order by hr_rank limit 5;
```